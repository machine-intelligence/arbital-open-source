<div flex>
	<div layout="column" layout-gt-sm="row" layout-align-gt-sm="start center" flex>

		<!-- New discussion thread -->
		<div ng-if="::topLevelComment === comment" flex>
			<arb-user-name user-id="{{::comment.pageCreatorId}}"></arb-user-name>
			commented on
			<arb-page-title page-id="{{::comment.getCommentParentPage().pageId}}" is-link="true"></arb-page-title>
			page:
			<arb-page-title page-id="{{::comment.pageId}}" is-link="true"></arb-page-title>
		</div>

		<!-- New reply -->
		<div ng-if="::topLevelComment !== comment" flex>
			<arb-user-name user-id="{{::comment.pageCreatorId}}"></arb-user-name>
			replied to
			<span ng-bind="::topLevelComment.pageCreatorId == userService.user.id ? 'your' : 'a'"></span>
			comment
			<arb-page-title page-id="{{::topLevelComment.pageId}}" is-link="true"></arb-page-title>:
			<arb-page-title page-id="{{::comment.pageId}}" is-link="true"></arb-page-title>
		</div>

		<div class="md-caption" layout="row" layout-align="start center">
			<span ng-bind="::(comment.pageCreatedAt | relativeDateTime)"></span>
		</div>
	</div>

	<!-- Toggle thread button -->
	<md-button class="md-primary"
			ng-click="toggleThread()"
			aria-label="Toggle thread"
			ng-bind="threadExpanded ? 'Collapse thread': 'Expand thread'">
	</md-button>

	<!-- Comment thread -->
	<div ng-if="threadExpanded">
		<md-progress-circular md-mode="indeterminate" ng-if="!threadLoaded"></md-progress-circular>
		<div arb-subpage class="reveal-after-render"
				lens-id="{{::topLevelComment.getCommentParentPage().pageId}}"
				page-id="{{::topLevelComment.pageId}}"
				ng-if="threadLoaded"></div>
	</div>
</div>
