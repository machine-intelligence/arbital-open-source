<div class="full-height" layout="row">
	<!-- Main edit column (left half) -->
	<div class="full-height" layout="column" flex="50">
		<md-tabs md-selected="selectedTab"
				md-stretch-tabs="always"
				md-border-bottom
				flex>
			<!-- (0) Title tab -->
			<md-tab label="Title">
				<md-tab-body>
					<div layout="column">
					<md-input-container>
						<label>Title</label>
						<input ng-model="page.title" md-maxlength="100">
					</md-input-container>
					<md-input-container>
						<label>Clickbait</label>
						<input ng-model="page.clickbait" md-maxlength="200">
					</md-input-container>
				</div>
				</md-tab-body>
			</md-tab>

			<!-- (1) Text tab -->
			<md-tab label="Text">
				<!-- Input we show when entering a new link -->
				<div class="edit-text-header" ng-show="showInsertLink">
					<arb-autocomplete class="insert-autocomplete"
							placeholder="Search for a page to link"
							on-select="insertLinkSelect(result)"></arb-autocomplete>
				</div>

				<!-- Markdown toolbar -->
				<div id="wmd-button-bar{{page.pageId}}" class="edit-text-header wmd-button-bar"
						layout="row"
						flex
						ng-hide="hideMarkdownToolbar || showInsertLink">
					<md-button class="wmd-bold-button">
						<md-icon>format_bold</md-icon>
						<md-tooltip>**Bold** | Ctrl+B</md-tooltip>
					</md-button>
					<md-button class="wmd-italic-button">
						<md-icon>format_italic</md-icon>
						<md-tooltip>**Italics** | Ctrl+I</md-tooltip>
					</md-button>
					<div class="separator"></div>
					<md-button class="wmd-link-button">
						<md-icon>insert_link</md-icon>
						<md-tooltip>[hyper](link) | Ctrl+L</md-tooltip>
					</md-button>
					<md-button class="wmd-intralink-button">
						<md-icon md-svg-icon="link_variant"></md-icon>
						<md-tooltip>[Intrasite link] | Ctrl+;</md-tooltip>
					</md-button>
					<!--<md-button class="wmd-new-page-button">
						<md-icon>note_add</md-icon>
						<md-tooltip>[New page link] | Ctrl+P</md-tooltip>
					</md-button>-->
					<div class="separator"></div>
					<md-button class="wmd-quote-button">
						<md-icon>format_quote</md-icon>
						<md-tooltip>&gt; Blockquote | Ctrl+Q</md-tooltip>
					</md-button>
					<md-button class="wmd-code-button">
						<md-icon>format_clear</md-icon>
						<md-tooltip>`Escape` | Ctrl+K</md-tooltip>
					</md-button>
					<md-button class="wmd-image-button">
						<md-icon>insert_photo</md-icon>
						<md-tooltip>![image](url) | Ctrl+G</md-tooltip>
					</md-button>
					<div class="separator"></div>
					<md-button class="wmd-olist-button">
						<md-icon>format_list_numbered</md-icon>
						<md-tooltip>1. Numbered list | Ctrl+O</md-tooltip>
					</md-button>
					<md-button class="wmd-ulist-button">
						<md-icon>format_list_bulleted</md-icon>
						<md-tooltip>* Bullet list | Ctrl+U</md-tooltip>
					</md-button>
					<md-button class="wmd-heading-button">
						<md-icon md-svg-icon="format_header_pound"></md-icon>
						<md-tooltip># Heading | Ctrl+H</md-tooltip>
					</md-button>
					<md-button class="wmd-hr-button">
						<md-icon>remove</md-icon>
						<md-tooltip>--- Line | Ctrl+E</md-tooltip>
					</md-button>
					<div class="separator"></div>
					<md-button class="wmd-undo-button">
						<md-icon>undo</md-icon>
						<md-tooltip>Undo | Ctrl+Z</md-tooltip>
					</md-button>
					<md-button class="wmd-redo-button">
						<md-icon>redo</md-icon>
						<md-tooltip>Redo | Ctrl+Shift+Z</md-tooltip>
					</md-button>
					<div flex></div>
					<md-button class="wmd-help-button">
						<md-icon>help</md-icon>
						<md-tooltip>Markdown editing help</md-tooltip>
					</md-button>
					<!--<div class="separator"></div>
					<md-button ng-click="hideMarkdownToolbar=true">
						<md-icon>close</md-icon>
						<md-tooltip>Close this toolbar</md-tooltip>
					</md-button>-->
				</div>
				<textarea name="text"
						class="wmd-input"
						id="wmd-input{{page.pageId}}"
						placeholder="Truth is singular. Its &#34;versions&#34; are mistruths.&#13;&#10;&mdash; Sonmi-451"
						ng-model="page.text"
						ng-readonly="lockedByAnother"
						ng-disabled="showInsertLink"
						flex></textarea>

				<!-- Footer -->
				<div class="edit-text-footer" layout="row" layout-align="start center">
					<!-- Lock timer -->
					<div ng-show="lockExists">
						<md-tooltip ng-show="page.lockedBy!='0' && page.lockedBy===userService.user.id">
							You have locked the page.
						</md-tooltip>
						<md-tooltip ng-show="lockedByAnother">
							This page is locked by another user.
						</md-tooltip>
						<md-icon>lock</md-icon>
						<span class="autoupdate" ng-bind="pageService.primaryPage.lockedUntil | relativeDateTime"></span>
					</div>
		
					<div flex></div>
		
					<div ng-show="!isPublishing && isAutosaving">
						Autosaving...
					</div>
					<div ng-show="isPublishing">
						Publishing...
					</div>
					<md-button class="md-warn" ng-disable="isPublishing">
						Discard
					</md-button>
					<md-button ng-disable="isPublishing">
						Snapshot
					</md-button>
					<md-button class="md-primary" ng-disable="isPublishing">
						Publish
					</md-button>
				</div>
			</md-tab>

			<!-- (2) Settings tab -->
			<md-tab label="Settings">
				<md-tab-body>
					<div layout="column" class="full-height">
						<!-- Page type -->
						<div layout="row">
							<md-input-container flex>
								<label>Page type</label>
								<md-select ng-model="page.type" required="true">
									<md-option ng-repeat="(key,value) in pageTypes" value="{{key}}">
										{{value}}
									</md-option>
								</md-select>
							</md-input-container>
							<div flex>
								<span ng-show="page.type === 'wiki'">
									Standard wiki page.
								</span>
								<span ng-show="page.type === 'lens'">
									A lens page is used to present the same material as another page but with a different emphasis.
								</span>
							</div>
						</div>
					
						<!-- Edit group id -->
						<div layout="row">
							<md-input-container flex>
								<label>Edit group</label>
								<md-select ng-model="page.editGroupId">
									<md-option ng-repeat="(key,value) in groupOptions" value="{{key}}">
										{{value}}
									</md-option>
								</md-select>
							</md-input-container>
							<div flex>
								A lens page is used to present the same material as another page but with a different emphasis.
							</div>
						</div>
					
						<!-- Show/hide vote -->
						<div layout="row" ng-show="page.lockedVoteType != '' && isWiki">
							<md-switch ng-model="page.hasVote" aria-label="Switch 1">
								Show the {{page.lockedVoteType}} voting bar
						  </md-switch>
						</div>
					
						<!-- Vote type -->
						<div layout="row" ng-show="page.lockedVoteType == '' && !isQuestion && !isComment">
							<md-input-container flex>
								<label>Voting</label>
								<md-select ng-model="page.voteType">
									<md-option ng-repeat="(key,value) in voteTypes" value="{{key}}">
										{{value}}
									</md-option>
								</md-select>
							</md-input-container>
							<div flex>
								<!-- TODO: helpful notes -->
							</div>
						</div>
					
						<!-- Karma edit lock -->
						<div layout="row" ng-show="userService.user.maxKarmaLock > 0 && !isComment">
							<div flex>
								<label>Edit karma lock</label>
								<md-slider md-discrete ng-model="page.editKarmaLock"
										step="10" min="0" max="{{userService.user.maxKarmaLock}}">
								</md-slider>
							</div>
							<div flex>
								Editing this page will require a this amount of karma
							</div>
						</div>
					
						<!-- Alias -->
						<div layout="row" ng-show="!isAnswer && !isComment && !isGroup">
							<div layout="column" flex>
								<md-input-container>
									<label>Alias</label>
									<input ng-model="page.alias" md-maxlength="50">
								</md-input-container>
							</div>
							<div flex>
								<div>Unique name for this page, e.g. "HumanHealth".</div>
								<div ng-show="page.seeGroupId != '0'">
									This alias will be prefixed with "{{pageService.pageMap[page.seeGroupId].alias}}."
									because it's part of the private domain.
								</div>
							</div>
						</div>
					
						<!-- Sort children option -->
						<div layout="row" ng-show="!isSecondary">
							<md-input-container flex>
								<label>Sort children</label>
								<md-select ng-model="page.sortChildrenBy">
									<md-option ng-repeat="(key,value) in sortTypes" value="{{key}}">
										{{value}}
									</md-option>
								</md-select>
							</md-input-container>
							<div flex>
								How to sort the children of this page
								<!-- TODO: helpful notes about specific types -->
							</div>
						</div>

						<div flex></div>

						<!-- Footer -->
						<div layout="column">
							<md-button class="md-raised md-primary">
								Save
							</md-button>
						</div>
					</div>
				</md-tab-body>
			</md-tab>

			<!-- (3) Changelog tab -->
			<md-tab label="Changelog">
				<md-tab-body>
					<arb-changelog page-id="{{page.pageId}}"><arb-changelog>
				</md-tab-body>
			</md-tab>

			<!-- (4) Relationships tab -->
			<md-tab label="Relationships">
				<md-tab-body>
					<div layout="column">
						<!-- Parents -->
						<arb-relationships page-id="{{page.pageId}}"
								type="parent"
								force-edit-mode="true"></arb-relationships>
						<!-- Tags -->
						<arb-relationships page-id="{{page.pageId}}"
								type="tag"
								force-edit-mode="true"></arb-relationships>
						<!-- Requirements -->
						<arb-relationships page-id="{{page.pageId}}"
								type="requirement"
								force-edit-mode="true"></arb-relationships>
					</div>
				</md-tab-body>
			</md-tab>
		</md-tabs>
	</div>

	<div class="wmd-preview-separator"></div>

	<!-- Preview (right half) -->
	<div class="full-height" layout="column" flex="50" ng-if="showPreview">
		<md-content flex>
			<h2 class="md-display-2" ng-bind="page.title"></h2>
			<div id="wmd-preview{{page.pageId}}"></div>
		</md-content>
		<div>
			SOME MESSAGES
			<md-button>A</md-button>
		</div>
	</div>
</div>
