{{/* editPage.tmpl is the page for creating a new page or editing an existing one. */}}
{{define "base"}}
<!DOCTYPE html>
<html>
<head>
	<title>{{if .Page.Title}}Edit - {{.Page.Title}}{{else}}New Page{{end}} - Arbital</title>
	{{template "style"}}
	{{template "scripts"}}
	{{template "angular" .}}
	<script src="/static/js/editPage.js"></script>
	<script>
		// MainCtrl is the main control for this page.
		app.controller("MainCtrl", function ($scope, pageService, userService) {
			$scope.pageId = "{{.Page.PageId}}";
			$scope.page = pageService.pageMap[$scope.pageId];

			// Called when the user is done editing the page.
			$scope.doneFn = function(result) {
				window.location.href = $scope.page.url(true);
			};
		});
	</script>
</head>

<body ng-app="arbital" ng-controller="ArbitalCtrl">
<arb-navbar></arb-navbar>

<!-- This modal is for inserting new links. -->
<arb-new-link-modal></arb-new-link-modal>

<!-- This modal is for creating new pages quickly. -->
<arb-edit-page-modal parent-page-id="{{.Page.PageId}}"></arb-edit-page-modal>

<div class="new-page-body-div" ng-controller="MainCtrl">
	<arb-edit-page page-id="{[{page.pageId}]}" done-fn="doneFn(result)"></arb-edit-page>
</div>

<arb-footer></arb-footer>
</body>
</html>
{{end}}
