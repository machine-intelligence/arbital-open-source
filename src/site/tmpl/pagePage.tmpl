{{/* page.tmpl is the base template file for displaying a page. */}}
{{define "base"}}
<!DOCTYPE html>
<html lang="en">
<head>
	{{template "style"}}
	<link href="/static/css/compiled/page.css" rel="stylesheet">
	<link href="/static/css/compiled/pagedown.css" rel="stylesheet">
	{{template "scripts"}}
	<script src="/static/js/page.js"></script>
	<script>
		var pageText = "{{.Page.Text}}";
	</script>
	<title>{{.Page.Title}} - Zanaduu</title>
</head>

<body page-id="{{.Page.PageId}}" page-type="{{.Page.Type}}" page-url="{{GetPageUrl .Page}}" last-visit="{{.Page.LastVisit}}">
{{template "navbar" .User}}

<div id="link-popover-template" hidden>
	<!-- Likes / dislikes and approval voting -->
	<span class="like-count">JS inserts likes</span>
	<span class="disabled-like-link glyphicon glyphicon-thumbs-up"></span>
	&nbsp;
	<span class="dislike-count">JS inserts dislikes</span>
	<span class="disabled-dislike-link glyphicon glyphicon-thumbs-down"></span>
	&nbsp; &nbsp;

	<div class="vote" hidden>
		<span class="answer answer1 pull-left">JS inserts answer1 text</span>
		&nbsp;&nbsp;<span class="vote-text">JS inserts vote value and vote count</span>
		<span class="answer answer2 pull-right">JS inserts answer2 text</span>
		<span class="clearfix"></span>
	</div>
</div>

{{with .Page}}
	{{if gt .DeletedBy 0}}
		<div class="page-body-div">
			<p class="text-center">This page has been deleted.
				{{if IsAdmin}}
					<span class="admin">By id: {{.DeletedBy}}. <a href="#" class="undo-page-delete">Undo.</a></span>
				{{end}}
			</p>
		</div>
	{{else}}
		<div class="page-body-div">
			<!-- Left column -->
			<div class="left-column pull-left">
				<!-- Likes / dislikes and approval voting -->
				<div class="like" my-like="{{.MyLikeValue}}">
					<div class="like-div">
						<span class="like-count">{{.LikeCount}}</span>
						{{if IsLoggedIn}}
							<a href="#" class="like-link glyphicon glyphicon-thumbs-up {{if ge .MyLikeValue 1}}on{{end}}"></a>
						{{else}}
							<span class="disabled-like-link glyphicon glyphicon-thumbs-up"></span>
						{{end}}
					</div>
					<div class="dislike-div">
						<span class="dislike-count">{{.DislikeCount}}</span>
						{{if IsLoggedIn}}
							<a href="#" class="dislike-link glyphicon glyphicon-thumbs-down {{if le .MyLikeValue -1}}on{{end}}"></a>
						{{else}}
							<span class="disabled-like-link glyphicon glyphicon-thumbs-down"></span>
						{{end}}
					</div>
				</div>

				<!-- Probability voting -->
				{{if .Answers}}
					<div class="vote">
						<span class="answer pull-left">{{(index .Answers 0).Text}}</span>
						&nbsp;&nbsp;<span>{{.VoteValue}} ({{.VoteCount}})</span>
						<span class="answer pull-right">{{(index .Answers 1).Text}}</span>
						<span class="clearfix"></span>
						<div class="vote-slider" vote-value="{{.VoteValue}}"></div>
						<div class="my-vote" {{if le .MyVoteValue 0.0}}hidden{{end}}>
							<span class="my-vote-value">{{.MyVoteValue}}</span>
							<a href="#" class="delete-my-vote-link glyphicon glyphicon-remove"></a>
						</div>
					</div>
				{{end}}

				<!-- Page icons like subscribe, edit, and delete. -->
				<div class="page-glyphs">
					{{if IsLoggedIn}}
						<a href="#" class="subscribe-to-page-link glyphicon glyphicon-eye-open {{if .IsSubscribed}}on{{end}}"></a></br>
					{{end}}
					{{if ShowEditIcons .}}
						{{if ge (GetEditLevel .) 0}}
							<a href="{{GetPageEditUrl .}}" class="edit-page-link glyphicon glyphicon-pencil {{if eq (GetEditLevel .) 0}}admin{{end}}"></a></br>
						{{end}}
						{{if ge (GetDeleteLevel .) 0}}
							<a href="#" class="delete-page-link glyphicon glyphicon-remove {{if eq (GetDeleteLevel .) 0}}admin{{end}}"></a></br>
						{{end}}
					{{end}}
					<div class="alert alert-danger fade in" id="delete-page-alert" hidden>
						<p>Are you sure you want to delete this page?</p>
						<button type="button" class="delete-page-confirm btn btn-danger">Delete</button>
						<button type="button" class="delete-page-cancel btn btn-default">Cancel</button></br>
					</div>
				</div>
			</div>
		
			<!-- Main page column -->
			<div class="mid-column pull-left">
				<span class="new-text">{{if IsUpdatedPage .}}(Updated){{end}}</span>
				{{if .PrivacyKey.Valid}}<span class="private-text dashed-underline" title="Nobody can access this page unless they have the exact URL.">(Private)</span>{{end}}
				<div class="page-title">{{.Title}}</div>
				{{if eq .Type "blog"}}
					<div class="author-text"> Author: {{template "userName" .Author}}</div>
				{{end}}
				<div class="page-text"></div>
		
				<!-- Tags -->
				{{if .Tags}}
					</br>
					{{range .Tags}}
						{{template "tag" .}}
					{{end}}
					</br>
				{{end}}
		
				<!--Admin stuff -->
				{{if IsAdmin}}
					<span class="admin">Last Visit: {{.LastVisit}}; Last Edit At: {{.CreatedAt}} by {{template "userName" .Author}}</span></br>
				{{end}}
		
				<!-- Comments -->
				<b>Comments:</b></br>
			</div>
			<div class="right-column pull-left">
				<p>Aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p>
			</div>
		</div>
		<div class="clearfix"></div>
		
		<div class="comments">
			{{range .Comments}}
				{{template "comment" .}}
			{{end}}
		</div>
		
		{{template "newComment" 0}}
	{{end}}
{{end}}

</body>
</html>
{{end}}
